HiFiberry DSP
*************

Software for HiFiBerry boards equipped with DSP. This package can be 
used to read/write data to HiFiBerry DSP boards using the Beocreate TCP 
server.

Installation
============

Before installing the dsptoolkit, you need to have a working Python 3
installation (>=3.5) and a working pip.

You can then install the toolkit by just running

 sudo pip3 install --upgrade hifiberrydsp

This will only install the software, but not activate the server.
Depending on your system, you might need to create a startup script 
or a systemd unit file for this.

If you're using a Debian based system (e.g. Debian, Raspbian), there
is a script that does all the work for you. Just run the following 
command:

 bash <(curl https://raw.githubusercontent.com/hifiberry/\
hifiberry-dsp/master/install-dsptoolkit)


sigmatcpserver
==============

This server runs in background and provides a TCP interface (port 8089) 
to access DSP functions. It is compatible with SigmaStudio. That means 
you can directly deploy DSP programs from SigmaStudio and change 
parameters online.

The server automatically dumps the so-called parameter RAM to the file 
system when it terminates. On startup, it checks for a parameter RAM 
file and if it exists it writes it back to the parameter memory. This 
ensures that parameters like volume controls, filter parameters, switch 
settings will be automatically restored even if they are not saved in 
the EEPROM. 

The server accepts the following command line parameters:

-v         Verbose output.
--alsa     Create an ALSA volume control that is synced with the volume 
           control of the running DSP program

Command line utility
====================

The dsptoolkit command is the main command line tool to communicate 
with the DSP TCP server. The command line parameters are documented
in doc/dsptoollkit.md


REW integration
===============

The software can be used to push filters created by Room Equalisation 
Wizard (REW) to the DSP.
Have a look at the guide in /doc/rew-basics.md

DSP profile format
==================

DSP profiles can be generated directly in SigmaStudio. However, to 
enable the full potential of DSP Profiles and allow DSPToolkit to 
directly control the DSP program, you need to add some additional 
metadata to the XML file.
The process to create a DSP profile is documented in /doc/dspprofiles.md

IIR filter format
=================

Standard IIR filters like high-pass, low-pass, bandpass and parametric 
equalisers can be described by a simple text syntax. This allows to 
create these filters from a textual respresentation that can be edited 
easyly without the need to use SigmaStudio to to filter adjustments 

* lp:frequency:q
  defines a second-order low-pass filter with the given corner frequency
  and quality. If quality isn't given, 0.707 is used (Butterworth filter)
* hp:frequency:q
  defines a second-order high-pass filter with the given corner frequency
  and quality. If quality isn't given, 0.707 is used (Butterworth filter)
* eq:frequency:q:gain
  defines a parametric equaliser with the given center frequency
  and quality. gain (in decibel) can be positive or negative
  
Often IIR filters can be chained to define more complex filters, e.g.

lp:1500Hz, lp:1500Hz, hp:300Hz:0.6, eq:1200Hz:2:+3dB

This defines a filter that consists of:
 - a 4th order low-pass at 1.5kHz (created from two 2nd order filters)
 - a 2nd order high-pass as 300Hz with a quality of 0.6
 - a parametric equaliser at 1.2kHz with a quality of 2.0 and +3dB gain  

